import{r as a,j as e,ba as w,am as f,a6 as d,B as R,F as k,b as p,av as g,aA as b,I as j,b8 as y,ar as P,z as W,Z as B}from"./mui-DmyK1VYO.js";import{l as E}from"./index-Bicryl7V.js";import{u as F,a as N}from"./router-ViNET1Ki.js";import"./vendor-Ckhrjn13.js";function T(){return new URLSearchParams(N().search)}const H=()=>{const v=F(),c=T().get("token"),[n,S]=a.useState(""),[l,C]=a.useState(""),[t,u]=a.useState(!1),[m,i]=a.useState(""),[r,x]=a.useState(""),[o,h]=a.useState({new:!1,confirm:!1});if(!c)return e.jsx(w,{maxWidth:"sm",sx:{mt:8},children:e.jsx(f,{sx:{p:4,borderRadius:3,textAlign:"center"},children:e.jsx(d,{severity:"error",children:"Invalid or missing reset token."})})});const A=async s=>{if(s.preventDefault(),i(""),x(""),!n||!l){i("Please fill in all fields.");return}if(n.length<6){i("Password must be at least 6 characters.");return}if(n!==l){i("Passwords do not match.");return}u(!0);try{await E.resetPassword({token:c,password:n}),x("Password reset successful! Redirecting to login..."),setTimeout(()=>v("/login",{state:{resetSuccess:!0}}),2e3)}catch(I){i(I.response?.data?.error||"Failed to reset password. The link may be invalid or expired.")}finally{u(!1)}};return e.jsx(R,{sx:{minHeight:"100vh",display:"flex",alignItems:"center",justifyContent:"center",bgcolor:"background.default"},children:e.jsx(w,{maxWidth:"sm",children:e.jsx(k,{in:!0,timeout:800,children:e.jsxs(f,{sx:{p:{xs:3,sm:6},borderRadius:3,boxShadow:3,textAlign:"center"},children:[e.jsx(p,{variant:"h5",sx:{fontWeight:700,mb:2},children:"Reset Your Password"}),e.jsx(p,{variant:"body2",sx:{mb:3},children:"Enter your new password below."}),e.jsxs("form",{onSubmit:A,children:[e.jsx(g,{label:"New Password",type:o.new?"text":"password",fullWidth:!0,margin:"normal",value:n,onChange:s=>S(s.target.value),disabled:t||!!r,InputProps:{endAdornment:e.jsx(b,{position:"end",children:e.jsx(j,{"aria-label":"toggle new password visibility",onClick:()=>h(s=>({...s,new:!s.new})),edge:"end",disabled:t||!!r,children:o.new?e.jsx(y,{}):e.jsx(P,{})})})}}),e.jsx(g,{label:"Confirm New Password",type:o.confirm?"text":"password",fullWidth:!0,margin:"normal",value:l,onChange:s=>C(s.target.value),disabled:t||!!r,InputProps:{endAdornment:e.jsx(b,{position:"end",children:e.jsx(j,{"aria-label":"toggle confirm password visibility",onClick:()=>h(s=>({...s,confirm:!s.confirm})),edge:"end",disabled:t||!!r,children:o.confirm?e.jsx(y,{}):e.jsx(P,{})})})}}),m&&e.jsx(d,{severity:"error",sx:{mt:2},children:m}),r&&e.jsx(d,{severity:"success",sx:{mt:2},children:r}),e.jsx(W,{type:"submit",variant:"contained",color:"primary",fullWidth:!0,sx:{mt:3,py:1.2},disabled:t||!!r,children:t?e.jsx(B,{size:24,color:"inherit"}):"Reset Password"})]})]})})})})};export{H as default};
