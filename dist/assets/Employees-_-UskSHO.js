import{u as se,a1 as re,j as e,B as t,F as te,a5 as F,a6 as ae,a4 as l,as as m,ay as ie,b as a,az as le,aj as de,aA as ne,aB as oe,aC as O,aD as i,aE as xe,k as P,am as V,h as c,d as h,I as b,ao as q,ap as H,t as M,v as U,w as _,at as me,au as ce,av as he,m as G,x as Q,y as z}from"./mui-DaYlJXyD.js";import{r as o}from"./vendor-Cr2nE3UY.js";import{u as ue,b as w,L as ge}from"./index-Cb3eoPjA.js";import{P as je}from"./PageHeader-DlP9MJR_.js";import"./router-B4FNaIx_.js";const ye=()=>{const $=se(),{user:d}=ue(),[X,I]=o.useState(!0),[Y,J]=o.useState([]),[K,k]=o.useState(!1),[Z,N]=o.useState(!1),[r,u]=o.useState(null),[g,ee]=o.useState(""),D=re($.breakpoints.down("sm")),v=s=>{var n;return((n=s==null?void 0:s.department)==null?void 0:n.name)||(s==null?void 0:s.departmentName)||(s==null?void 0:s.department)||(s==null?void 0:s.department_id)||(s==null?void 0:s.departmentId)||"N/A"},[x,y]=o.useState({email:"",firstName:"",lastName:"",role:"employee",departmentId:(d==null?void 0:d.departmentId)||""});o.useEffect(()=>{S()},[]);const S=async()=>{I(!0);try{let s;d.role==="admin"?s=await w.getAll():d.role==="department_head"?s=await w.getDepartmentUsers(d.departmentId):s={data:[]},J(s.data)}catch(s){console.error("Failed to load employees",s)}finally{I(!1)}},E=(s=null)=>{s?(u(s),y({email:s.email,firstName:s.firstname||s.firstName,lastName:s.lastname||s.lastName,role:s.role,departmentId:s.departmentId})):(u(null),y({email:"",firstName:"",lastName:"",role:"employee",departmentId:(d==null?void 0:d.departmentId)||""})),k(!0)},W=()=>{k(!1),u(null)},R=s=>{u(s),N(!0)},B=()=>{N(!1),u(null)},j=s=>{const{name:n,value:p}=s.target;y(f=>({...f,[n]:p}))},L=async s=>{s.preventDefault();try{r?await w.update(r.id,x):await w.create(x),W(),S()}catch(n){console.error("Failed to save employee",n)}},C=Y.filter(s=>s.role==="employee").filter(s=>{var p,f,T,A;return(((p=s.firstName)==null?void 0:p.toLowerCase())||"").includes(g.toLowerCase())||(((f=s.lastName)==null?void 0:f.toLowerCase())||"").includes(g.toLowerCase())||(((T=s.email)==null?void 0:T.toLowerCase())||"").includes(g.toLowerCase())||(((A=s.username)==null?void 0:A.toLowerCase())||"").includes(g.toLowerCase())});return X?e.jsx(ge,{overlay:!0,message:"Loading employees..."}):e.jsxs(t,{sx:{flexGrow:1,pt:{xs:7,sm:3,md:4},px:{xs:1,sm:2,md:3},display:"flex",flexDirection:"column",height:"100%"},children:[e.jsx(je,{title:"Employees",subtitle:"Manage your department's employees.",emoji:"🧑‍💼",color:"primary",onRefresh:S}),e.jsx(t,{sx:{flexGrow:1,minHeight:0,overflowY:"auto"},children:e.jsx(te,{in:!0,timeout:800,children:e.jsxs(t,{children:[e.jsx(F,{sx:{mb:{xs:3,sm:4,md:5},borderRadius:3,boxShadow:"0 2px 12px rgba(0,0,0,0.08)"},children:e.jsx(ae,{sx:{p:{xs:2,sm:2.5,md:3}},children:e.jsx(l,{container:!0,spacing:{xs:2,sm:3},children:e.jsx(l,{item:!0,xs:12,sm:8,md:6,children:e.jsx(m,{fullWidth:!0,placeholder:"Search employees...",value:g,onChange:s=>ee(s.target.value),InputProps:{startAdornment:e.jsx(ie,{color:"action"})},sx:{"& .MuiOutlinedInput-root":{borderRadius:2}}})})})})}),C.length===0?e.jsx(t,{sx:{p:4,textAlign:"center",color:"text.secondary"},children:e.jsx(a,{variant:"body1",children:"No employees found. Try adjusting your search query."})}):e.jsxs(e.Fragment,{children:[e.jsx(t,{sx:{display:{xs:"none",md:"block"}},children:e.jsx(le,{component:de,sx:{borderRadius:3,boxShadow:3,overflowX:"auto",width:"100%",maxWidth:"100vw",bgcolor:"background.paper"},children:e.jsxs(ne,{size:"medium",sx:{minWidth:{md:0,lg:900},width:"100%",tableLayout:"fixed"},children:[e.jsx(oe,{children:e.jsxs(O,{sx:{position:"sticky",top:0,zIndex:2,bgcolor:"background.paper",boxShadow:"0 2px 8px rgba(0,0,0,0.04)"},children:[e.jsx(i,{padding:"checkbox",sx:{fontWeight:700,fontSize:{md:"0.92rem",lg:"1rem"},borderBottom:"2px solid",borderColor:"divider",px:{md:.5,lg:2},width:{md:36,lg:48}}}),e.jsx(i,{sx:{fontWeight:700,fontSize:{md:"0.92rem",lg:"1rem"},borderBottom:"2px solid",borderColor:"divider",px:{md:.5,lg:2},width:{md:56,lg:80}},children:"Avatar"}),e.jsx(i,{sx:{fontWeight:700,fontSize:{md:"0.92rem",lg:"1rem"},borderBottom:"2px solid",borderColor:"divider",px:{md:.5,lg:2},maxWidth:{md:120,lg:220},minWidth:80},children:"Name"}),e.jsx(i,{sx:{fontWeight:700,fontSize:{md:"0.92rem",lg:"1rem"},borderBottom:"2px solid",borderColor:"divider",px:{md:.5,lg:2},maxWidth:{md:120,lg:220},minWidth:80},children:"Email"}),e.jsx(i,{sx:{fontWeight:700,fontSize:{md:"0.92rem",lg:"1rem"},borderBottom:"2px solid",borderColor:"divider",px:{md:.5,lg:2},width:{md:60,lg:120},maxWidth:{md:80,lg:160}},children:"Role"}),e.jsx(i,{sx:{fontWeight:700,fontSize:{md:"0.92rem",lg:"1rem"},borderBottom:"2px solid",borderColor:"divider",px:{md:.5,lg:2},width:{md:60,lg:120},maxWidth:{md:80,lg:160}},children:"Department"}),e.jsx(i,{sx:{fontWeight:700,fontSize:{md:"0.92rem",lg:"1rem"},borderBottom:"2px solid",borderColor:"divider",px:{md:.5,lg:2},width:{md:60,lg:120},maxWidth:{md:80,lg:160}},children:"Status"}),e.jsx(i,{align:"right",sx:{fontWeight:700,fontSize:{md:"0.92rem",lg:"1rem"},borderBottom:"2px solid",borderColor:"divider",px:{md:.5,lg:2},minWidth:{md:60,lg:80}},children:"Actions"})]})}),e.jsx(xe,{children:C.map((s,n)=>e.jsxs(O,{hover:!0,sx:{bgcolor:n%2===0?"background.default":"background.paper",transition:"background 0.2s","&:hover":{bgcolor:"action.hover"}},children:[e.jsx(i,{padding:"checkbox",sx:{px:{md:.5,lg:2},width:{md:36,lg:48}}}),e.jsx(i,{sx:{px:{md:.5,lg:2},width:{md:56,lg:80}},children:e.jsx(P,{sx:{bgcolor:"primary.main",width:{md:32,lg:40},height:{md:32,lg:40},boxShadow:"0 1px 4px rgba(0,0,0,0.08)"},children:e.jsx(V,{})})}),e.jsx(i,{sx:{maxWidth:{md:120,lg:220},minWidth:80,px:{md:.5,lg:2}},children:e.jsx(c,{title:`${s.firstname} ${s.lastname}`,arrow:!0,children:e.jsxs(a,{variant:"subtitle1",noWrap:!0,sx:{fontWeight:700,fontSize:{md:"0.92rem",lg:"1rem"},wordBreak:"break-word",maxWidth:{md:110,lg:200}},children:[s.firstname," ",s.lastname]})})}),e.jsx(i,{sx:{maxWidth:{md:120,lg:220},minWidth:80,px:{md:.5,lg:2}},children:e.jsx(c,{title:s.email,arrow:!0,children:e.jsx(a,{variant:"body2",color:"text.secondary",noWrap:!0,sx:{fontSize:{md:"0.8rem",lg:"0.92rem"},lineHeight:1.4,wordBreak:"break-word",maxWidth:{md:110,lg:200}},children:s.email})})}),e.jsx(i,{sx:{px:{md:.5,lg:2},width:{md:60,lg:120},maxWidth:{md:80,lg:160}},children:e.jsx(h,{label:s.role,size:"small",color:s.role==="admin"?"error":s.role==="department_head"?"primary":"success",sx:{fontSize:{md:"0.65rem",lg:"0.78rem"},fontWeight:600,borderRadius:2,px:1,height:{md:16,lg:22},boxShadow:1,minWidth:{lg:70},justifyContent:"center"}})}),e.jsx(i,{sx:{px:{md:.5,lg:2},width:{md:60,lg:120},maxWidth:{md:80,lg:160}},children:e.jsx(h,{label:v(s),size:"small",color:"info",sx:{fontSize:{md:"0.65rem",lg:"0.78rem"},fontWeight:600,borderRadius:2,px:1,height:{md:16,lg:22},boxShadow:1,minWidth:{lg:70},justifyContent:"center"}})}),e.jsx(i,{sx:{px:{md:.5,lg:2},width:{md:60,lg:120},maxWidth:{md:80,lg:160}},children:e.jsx(h,{label:s.status||"active",size:"small",color:s.status==="inactive"?"default":"success",sx:{fontSize:{md:"0.65rem",lg:"0.78rem"},fontWeight:600,borderRadius:2,px:1,height:{md:16,lg:22},boxShadow:1,minWidth:{lg:70},justifyContent:"center"}})}),e.jsx(i,{align:"right",sx:{minWidth:{md:60,lg:80},px:{md:.5,lg:2}},children:e.jsxs(t,{sx:{display:"flex",alignItems:"center",gap:.2,flexWrap:"wrap",justifyContent:"flex-end",bgcolor:"action.selected",borderRadius:2,px:1,py:.5,boxShadow:1},children:[e.jsx(c,{title:"View",children:e.jsx("span",{children:e.jsx(b,{color:"primary",size:"small",onClick:()=>R(s),children:e.jsx(q,{fontSize:"small"})})})}),e.jsx(c,{title:"Edit",children:e.jsx("span",{children:e.jsx(b,{color:"secondary",size:"small",onClick:()=>E(s),children:e.jsx(H,{fontSize:"small"})})})})]})})]},s.id))})]})})}),e.jsx(t,{sx:{display:{xs:"block",md:"none"}},children:e.jsx(l,{container:!0,spacing:2,children:C.map(s=>e.jsx(l,{item:!0,xs:12,children:e.jsxs(F,{sx:{borderRadius:3,boxShadow:3,p:2,bgcolor:"background.paper"},children:[e.jsxs(t,{sx:{display:"flex",alignItems:"center",mb:1},children:[e.jsx(P,{sx:{bgcolor:"primary.main",width:36,height:36,boxShadow:"0 1px 4px rgba(0,0,0,0.08)",mr:1},children:e.jsx(V,{})}),e.jsxs(t,{sx:{flex:1},children:[e.jsxs(a,{variant:"subtitle1",sx:{fontWeight:700,fontSize:"1rem",wordBreak:"break-word"},children:[s.firstname," ",s.lastname]}),e.jsx(a,{variant:"body2",color:"text.secondary",sx:{fontSize:"0.92rem",lineHeight:1.4,wordBreak:"break-word"},children:s.email})]})]}),e.jsxs(t,{sx:{display:"flex",alignItems:"center",gap:1,flexWrap:"wrap",mb:1},children:[e.jsx(h,{label:s.role,size:"small",color:s.role==="admin"?"error":s.role==="department_head"?"primary":"success",sx:{fontSize:"0.78rem",fontWeight:600,borderRadius:2,px:1,height:20}}),e.jsx(h,{label:v(s),size:"small",color:"info",sx:{fontSize:"0.78rem",fontWeight:600,borderRadius:2,px:1,height:20}}),e.jsx(h,{label:s.status||"active",size:"small",color:s.status==="inactive"?"default":"success",sx:{fontSize:"0.78rem",fontWeight:600,borderRadius:2,px:1,height:20}})]}),e.jsxs(t,{sx:{display:"flex",alignItems:"center",gap:.5,justifyContent:"flex-end",bgcolor:"action.selected",borderRadius:2,px:1,py:.5,boxShadow:1},children:[e.jsx(c,{title:"View",children:e.jsx("span",{children:e.jsx(b,{color:"primary",size:"small",onClick:()=>R(s),children:e.jsx(q,{})})})}),e.jsx(c,{title:"Edit",children:e.jsx("span",{children:e.jsx(b,{color:"secondary",size:"small",onClick:()=>E(s),children:e.jsx(H,{})})})})]})]})},s.id))})})]}),e.jsxs(M,{open:K,onClose:W,maxWidth:"sm",fullWidth:!0,fullScreen:D,children:[e.jsxs(U,{sx:{fontSize:{xs:"1.25rem",sm:"1.5rem"},pb:{xs:1,sm:2}},children:[r?"Edit Employee":"Add New Employee",r&&e.jsx(a,{variant:"body2",color:"text.secondary",sx:{mt:1,fontSize:"0.875rem"},children:"Note: Name, email, and role cannot be changed for existing employees"})]}),e.jsx(_,{sx:{pt:{xs:1,sm:2}},children:e.jsx(t,{component:"form",onSubmit:L,sx:{mt:1},children:e.jsxs(l,{container:!0,spacing:{xs:1.5,sm:2},children:[e.jsx(l,{item:!0,xs:12,sm:6,children:e.jsx(m,{fullWidth:!0,label:"First Name",name:"firstName",value:x.firstName,onChange:j,required:!0,disabled:!!r,InputProps:{readOnly:!!r}})}),e.jsx(l,{item:!0,xs:12,sm:6,children:e.jsx(m,{fullWidth:!0,label:"Last Name",name:"lastName",value:x.lastName,onChange:j,required:!0,disabled:!!r,InputProps:{readOnly:!!r}})}),e.jsx(l,{item:!0,xs:12,children:e.jsx(m,{fullWidth:!0,label:"Email",name:"email",type:"email",value:x.email,onChange:j,required:!0,disabled:!!r,InputProps:{readOnly:!!r}})}),r&&e.jsx(l,{item:!0,xs:12,children:e.jsx(m,{fullWidth:!0,label:"User ID",value:r.id,disabled:!0})}),e.jsx(l,{item:!0,xs:12,sm:6,children:e.jsxs(me,{fullWidth:!0,children:[e.jsx(ce,{children:"Role"}),e.jsxs(he,{name:"role",value:x.role,label:"Role",onChange:j,disabled:!!r,children:[e.jsx(G,{value:"employee",children:"Employee"}),e.jsx(G,{value:"supervisor",children:"Supervisor"})]})]})}),e.jsx(l,{item:!0,xs:12,sm:6,children:e.jsx(m,{fullWidth:!0,label:"Department ID",name:"departmentId",value:x.departmentId,onChange:j,required:!0})})]})})}),e.jsxs(Q,{sx:{p:{xs:1.5,sm:2}},children:[e.jsx(z,{onClick:W,children:"Cancel"}),e.jsx(z,{variant:"contained",onClick:L,sx:{minWidth:100},children:r?"Update":"Create"})]})]}),e.jsxs(M,{open:Z,onClose:B,maxWidth:"sm",fullWidth:!0,fullScreen:D,children:[e.jsx(U,{sx:{fontSize:{xs:"1.25rem",sm:"1.5rem"},pb:{xs:1,sm:2}},children:"Employee Information"}),e.jsx(_,{sx:{pt:{xs:1,sm:2}},children:r&&e.jsxs(t,{sx:{display:"grid",gridTemplateColumns:{xs:"1fr",sm:"1fr 1fr"},gap:2},children:[e.jsxs(t,{children:[e.jsx(a,{variant:"subtitle2",color:"text.secondary",children:"First Name"}),e.jsx(a,{variant:"body1",children:r.firstname||r.firstName||"-"})]}),e.jsxs(t,{children:[e.jsx(a,{variant:"subtitle2",color:"text.secondary",children:"Last Name"}),e.jsx(a,{variant:"body1",children:r.lastname||r.lastName||"-"})]}),e.jsxs(t,{children:[e.jsx(a,{variant:"subtitle2",color:"text.secondary",children:"Email"}),e.jsx(a,{variant:"body1",children:r.email||"-"})]}),e.jsxs(t,{children:[e.jsx(a,{variant:"subtitle2",color:"text.secondary",children:"User ID"}),e.jsx(a,{variant:"body1",children:r.id||"-"})]}),e.jsxs(t,{children:[e.jsx(a,{variant:"subtitle2",color:"text.secondary",children:"Role"}),e.jsx(a,{variant:"body1",children:r.role||"-"})]}),e.jsxs(t,{children:[e.jsx(a,{variant:"subtitle2",color:"text.secondary",children:"Department"}),e.jsx(a,{variant:"body1",children:v(r)})]}),e.jsxs(t,{children:[e.jsx(a,{variant:"subtitle2",color:"text.secondary",children:"Status"}),e.jsx(a,{variant:"body1",children:r.status||"active"})]})]})}),e.jsx(Q,{sx:{p:{xs:1.5,sm:2}},children:e.jsx(z,{onClick:B,children:"Close"})})]})]})})})]})};export{ye as default};
