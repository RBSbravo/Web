import{u as Z,r as d,a4 as ee,j as e,B as t,F as se,a8 as B,a9 as re,a7 as l,av as x,aB as te,b as a,aC as ae,am as ie,aD as le,aE as de,aF as L,aG as i,aH as ne,k as T,ap as F,h as m,d as c,I as j,ar as A,as as O,v as P,w as H,x as V,aw as oe,ax as xe,ay as me,m as q,y as M,z as W}from"./mui-BvrjgOXm.js";import{u as ce,b as f,L as he}from"./index-Cxi1EjIi.js";import{P as ue}from"./PageHeader-DWvGCfo2.js";import"./vendor-Ckhrjn13.js";import"./router-D0O_2iby.js";const we=()=>{const U=Z(),{user:h}=ce(),[G,C]=d.useState(!0),[_,Q]=d.useState([]),[$,z]=d.useState(!1),[X,I]=d.useState(!1),[r,u]=d.useState(null),[g,Y]=d.useState(""),k=ee(U.breakpoints.down("sm")),b=s=>s?.department?.name||s?.departmentName||s?.department||s?.department_id||s?.departmentId||"N/A",[n,w]=d.useState({email:"",firstName:"",lastName:"",role:"employee",departmentId:h?.departmentId||""});d.useEffect(()=>{v()},[]);const v=async()=>{C(!0);try{let s;h.role==="admin"?s=await f.getAll():h.role==="department_head"?s=await f.getDepartmentUsers(h.departmentId):s={data:[]},Q(s.data)}catch(s){console.error("Failed to load employees",s)}finally{C(!1)}},N=(s=null)=>{s?(u(s),w({email:s.email,firstName:s.firstname||s.firstName,lastName:s.lastname||s.lastName,role:s.role,departmentId:s.departmentId})):(u(null),w({email:"",firstName:"",lastName:"",role:"employee",departmentId:h?.departmentId||""})),z(!0)},y=()=>{z(!1),u(null)},D=s=>{u(s),I(!0)},E=()=>{I(!1),u(null)},p=s=>{const{name:o,value:J}=s.target;w(K=>({...K,[o]:J}))},R=async s=>{s.preventDefault();try{r?await f.update(r.id,n):await f.create(n),y(),v()}catch(o){console.error("Failed to save employee",o)}},S=_.filter(s=>s.role==="employee").filter(s=>(s.firstName?.toLowerCase()||"").includes(g.toLowerCase())||(s.lastName?.toLowerCase()||"").includes(g.toLowerCase())||(s.email?.toLowerCase()||"").includes(g.toLowerCase())||(s.username?.toLowerCase()||"").includes(g.toLowerCase()));return G?e.jsx(he,{overlay:!0,message:"Loading employees..."}):e.jsxs(t,{sx:{flexGrow:1,pt:{xs:7,sm:3,md:4},px:{xs:1,sm:2,md:3},display:"flex",flexDirection:"column",height:"100%"},children:[e.jsx(ue,{title:"Employees",subtitle:"Manage your department's employees.",emoji:"🧑‍💼",color:"primary",onRefresh:v}),e.jsx(t,{sx:{flexGrow:1,minHeight:0,overflowY:"auto"},children:e.jsx(se,{in:!0,timeout:800,children:e.jsxs(t,{children:[e.jsx(B,{sx:{mb:{xs:3,sm:4,md:5},borderRadius:3,boxShadow:"0 2px 12px rgba(0,0,0,0.08)"},children:e.jsx(re,{sx:{p:{xs:2,sm:2.5,md:3}},children:e.jsx(l,{container:!0,spacing:{xs:2,sm:3},children:e.jsx(l,{item:!0,xs:12,sm:8,md:6,children:e.jsx(x,{fullWidth:!0,placeholder:"Search employees...",value:g,onChange:s=>Y(s.target.value),InputProps:{startAdornment:e.jsx(te,{color:"action"})},sx:{"& .MuiOutlinedInput-root":{borderRadius:2}}})})})})}),S.length===0?e.jsx(t,{sx:{p:4,textAlign:"center",color:"text.secondary"},children:e.jsx(a,{variant:"body1",children:"No employees found. Try adjusting your search query."})}):e.jsxs(e.Fragment,{children:[e.jsx(t,{sx:{display:{xs:"none",md:"block"}},children:e.jsx(ae,{component:ie,sx:{borderRadius:3,boxShadow:3,overflowX:"auto",width:"100%",maxWidth:"100vw",bgcolor:"background.paper"},children:e.jsxs(le,{size:"medium",sx:{minWidth:{md:0,lg:900},width:"100%",tableLayout:"fixed"},children:[e.jsx(de,{children:e.jsxs(L,{sx:{position:"sticky",top:0,zIndex:2,bgcolor:"background.paper",boxShadow:"0 2px 8px rgba(0,0,0,0.04)"},children:[e.jsx(i,{padding:"checkbox",sx:{fontWeight:700,fontSize:{md:"0.92rem",lg:"1rem"},borderBottom:"2px solid",borderColor:"divider",px:{md:.5,lg:2},width:{md:36,lg:48}}}),e.jsx(i,{sx:{fontWeight:700,fontSize:{md:"0.92rem",lg:"1rem"},borderBottom:"2px solid",borderColor:"divider",px:{md:.5,lg:2},width:{md:56,lg:80}},children:"Avatar"}),e.jsx(i,{sx:{fontWeight:700,fontSize:{md:"0.92rem",lg:"1rem"},borderBottom:"2px solid",borderColor:"divider",px:{md:.5,lg:2},maxWidth:{md:120,lg:220},minWidth:80},children:"Name"}),e.jsx(i,{sx:{fontWeight:700,fontSize:{md:"0.92rem",lg:"1rem"},borderBottom:"2px solid",borderColor:"divider",px:{md:.5,lg:2},maxWidth:{md:120,lg:220},minWidth:80},children:"Email"}),e.jsx(i,{sx:{fontWeight:700,fontSize:{md:"0.92rem",lg:"1rem"},borderBottom:"2px solid",borderColor:"divider",px:{md:.5,lg:2},width:{md:60,lg:120},maxWidth:{md:80,lg:160}},children:"Role"}),e.jsx(i,{sx:{fontWeight:700,fontSize:{md:"0.92rem",lg:"1rem"},borderBottom:"2px solid",borderColor:"divider",px:{md:.5,lg:2},width:{md:60,lg:120},maxWidth:{md:80,lg:160}},children:"Department"}),e.jsx(i,{sx:{fontWeight:700,fontSize:{md:"0.92rem",lg:"1rem"},borderBottom:"2px solid",borderColor:"divider",px:{md:.5,lg:2},width:{md:60,lg:120},maxWidth:{md:80,lg:160}},children:"Status"}),e.jsx(i,{align:"right",sx:{fontWeight:700,fontSize:{md:"0.92rem",lg:"1rem"},borderBottom:"2px solid",borderColor:"divider",px:{md:.5,lg:2},minWidth:{md:60,lg:80}},children:"Actions"})]})}),e.jsx(ne,{children:S.map((s,o)=>e.jsxs(L,{hover:!0,sx:{bgcolor:o%2===0?"background.default":"background.paper",transition:"background 0.2s","&:hover":{bgcolor:"action.hover"}},children:[e.jsx(i,{padding:"checkbox",sx:{px:{md:.5,lg:2},width:{md:36,lg:48}}}),e.jsx(i,{sx:{px:{md:.5,lg:2},width:{md:56,lg:80}},children:e.jsx(T,{sx:{bgcolor:"primary.main",width:{md:32,lg:40},height:{md:32,lg:40},boxShadow:"0 1px 4px rgba(0,0,0,0.08)"},children:e.jsx(F,{})})}),e.jsx(i,{sx:{maxWidth:{md:120,lg:220},minWidth:80,px:{md:.5,lg:2}},children:e.jsx(m,{title:`${s.firstname} ${s.lastname}`,arrow:!0,children:e.jsxs(a,{variant:"subtitle1",noWrap:!0,sx:{fontWeight:700,fontSize:{md:"0.92rem",lg:"1rem"},wordBreak:"break-word",maxWidth:{md:110,lg:200}},children:[s.firstname," ",s.lastname]})})}),e.jsx(i,{sx:{maxWidth:{md:120,lg:220},minWidth:80,px:{md:.5,lg:2}},children:e.jsx(m,{title:s.email,arrow:!0,children:e.jsx(a,{variant:"body2",color:"text.secondary",noWrap:!0,sx:{fontSize:{md:"0.8rem",lg:"0.92rem"},lineHeight:1.4,wordBreak:"break-word",maxWidth:{md:110,lg:200}},children:s.email})})}),e.jsx(i,{sx:{px:{md:.5,lg:2},width:{md:60,lg:120},maxWidth:{md:80,lg:160}},children:e.jsx(c,{label:s.role,size:"small",color:s.role==="admin"?"error":s.role==="department_head"?"primary":"success",sx:{fontSize:{md:"0.65rem",lg:"0.78rem"},fontWeight:600,borderRadius:2,px:1,height:{md:16,lg:22},boxShadow:1,minWidth:{lg:70},justifyContent:"center"}})}),e.jsx(i,{sx:{px:{md:.5,lg:2},width:{md:60,lg:120},maxWidth:{md:80,lg:160}},children:e.jsx(c,{label:b(s),size:"small",color:"info",sx:{fontSize:{md:"0.65rem",lg:"0.78rem"},fontWeight:600,borderRadius:2,px:1,height:{md:16,lg:22},boxShadow:1,minWidth:{lg:70},justifyContent:"center"}})}),e.jsx(i,{sx:{px:{md:.5,lg:2},width:{md:60,lg:120},maxWidth:{md:80,lg:160}},children:e.jsx(c,{label:s.status||"active",size:"small",color:s.status==="inactive"?"default":"success",sx:{fontSize:{md:"0.65rem",lg:"0.78rem"},fontWeight:600,borderRadius:2,px:1,height:{md:16,lg:22},boxShadow:1,minWidth:{lg:70},justifyContent:"center"}})}),e.jsx(i,{align:"right",sx:{minWidth:{md:60,lg:80},px:{md:.5,lg:2}},children:e.jsxs(t,{sx:{display:"flex",alignItems:"center",gap:.2,flexWrap:"wrap",justifyContent:"flex-end",bgcolor:"action.selected",borderRadius:2,px:1,py:.5,boxShadow:1},children:[e.jsx(m,{title:"View",children:e.jsx("span",{children:e.jsx(j,{color:"primary",size:"small",onClick:()=>D(s),children:e.jsx(A,{fontSize:"small"})})})}),e.jsx(m,{title:"Edit",children:e.jsx("span",{children:e.jsx(j,{color:"secondary",size:"small",onClick:()=>N(s),children:e.jsx(O,{fontSize:"small"})})})})]})})]},s.id))})]})})}),e.jsx(t,{sx:{display:{xs:"block",md:"none"}},children:e.jsx(l,{container:!0,spacing:2,children:S.map(s=>e.jsx(l,{item:!0,xs:12,children:e.jsxs(B,{sx:{borderRadius:3,boxShadow:3,p:2,bgcolor:"background.paper"},children:[e.jsxs(t,{sx:{display:"flex",alignItems:"center",mb:1},children:[e.jsx(T,{sx:{bgcolor:"primary.main",width:36,height:36,boxShadow:"0 1px 4px rgba(0,0,0,0.08)",mr:1},children:e.jsx(F,{})}),e.jsxs(t,{sx:{flex:1},children:[e.jsxs(a,{variant:"subtitle1",sx:{fontWeight:700,fontSize:"1rem",wordBreak:"break-word"},children:[s.firstname," ",s.lastname]}),e.jsx(a,{variant:"body2",color:"text.secondary",sx:{fontSize:"0.92rem",lineHeight:1.4,wordBreak:"break-word"},children:s.email})]})]}),e.jsxs(t,{sx:{display:"flex",alignItems:"center",gap:1,flexWrap:"wrap",mb:1},children:[e.jsx(c,{label:s.role,size:"small",color:s.role==="admin"?"error":s.role==="department_head"?"primary":"success",sx:{fontSize:"0.78rem",fontWeight:600,borderRadius:2,px:1,height:20}}),e.jsx(c,{label:b(s),size:"small",color:"info",sx:{fontSize:"0.78rem",fontWeight:600,borderRadius:2,px:1,height:20}}),e.jsx(c,{label:s.status||"active",size:"small",color:s.status==="inactive"?"default":"success",sx:{fontSize:"0.78rem",fontWeight:600,borderRadius:2,px:1,height:20}})]}),e.jsxs(t,{sx:{display:"flex",alignItems:"center",gap:.5,justifyContent:"flex-end",bgcolor:"action.selected",borderRadius:2,px:1,py:.5,boxShadow:1},children:[e.jsx(m,{title:"View",children:e.jsx("span",{children:e.jsx(j,{color:"primary",size:"small",onClick:()=>D(s),children:e.jsx(A,{})})})}),e.jsx(m,{title:"Edit",children:e.jsx("span",{children:e.jsx(j,{color:"secondary",size:"small",onClick:()=>N(s),children:e.jsx(O,{})})})})]})]})},s.id))})})]}),e.jsxs(P,{open:$,onClose:y,maxWidth:"sm",fullWidth:!0,fullScreen:k,children:[e.jsxs(H,{sx:{fontSize:{xs:"1.25rem",sm:"1.5rem"},pb:{xs:1,sm:2}},children:[r?"Edit Employee":"Add New Employee",r&&e.jsx(a,{variant:"body2",color:"text.secondary",sx:{mt:1,fontSize:"0.875rem"},children:"Note: Name, email, and role cannot be changed for existing employees"})]}),e.jsx(V,{sx:{pt:{xs:1,sm:2}},children:e.jsx(t,{component:"form",onSubmit:R,sx:{mt:1},children:e.jsxs(l,{container:!0,spacing:{xs:1.5,sm:2},children:[e.jsx(l,{item:!0,xs:12,sm:6,children:e.jsx(x,{fullWidth:!0,label:"First Name",name:"firstName",value:n.firstName,onChange:p,required:!0,disabled:!!r,InputProps:{readOnly:!!r}})}),e.jsx(l,{item:!0,xs:12,sm:6,children:e.jsx(x,{fullWidth:!0,label:"Last Name",name:"lastName",value:n.lastName,onChange:p,required:!0,disabled:!!r,InputProps:{readOnly:!!r}})}),e.jsx(l,{item:!0,xs:12,children:e.jsx(x,{fullWidth:!0,label:"Email",name:"email",type:"email",value:n.email,onChange:p,required:!0,disabled:!!r,InputProps:{readOnly:!!r}})}),r&&e.jsx(l,{item:!0,xs:12,children:e.jsx(x,{fullWidth:!0,label:"User ID",value:r.id,disabled:!0})}),e.jsx(l,{item:!0,xs:12,sm:6,children:e.jsxs(oe,{fullWidth:!0,children:[e.jsx(xe,{children:"Role"}),e.jsxs(me,{name:"role",value:n.role,label:"Role",onChange:p,disabled:!!r,children:[e.jsx(q,{value:"employee",children:"Employee"}),e.jsx(q,{value:"supervisor",children:"Supervisor"})]})]})}),e.jsx(l,{item:!0,xs:12,sm:6,children:e.jsx(x,{fullWidth:!0,label:"Department ID",name:"departmentId",value:n.departmentId,onChange:p,required:!0})})]})})}),e.jsxs(M,{sx:{p:{xs:1.5,sm:2}},children:[e.jsx(W,{onClick:y,children:"Cancel"}),e.jsx(W,{variant:"contained",onClick:R,sx:{minWidth:100},children:r?"Update":"Create"})]})]}),e.jsxs(P,{open:X,onClose:E,maxWidth:"sm",fullWidth:!0,fullScreen:k,children:[e.jsx(H,{sx:{fontSize:{xs:"1.25rem",sm:"1.5rem"},pb:{xs:1,sm:2}},children:"Employee Information"}),e.jsx(V,{sx:{pt:{xs:1,sm:2}},children:r&&e.jsxs(t,{sx:{display:"grid",gridTemplateColumns:{xs:"1fr",sm:"1fr 1fr"},gap:2},children:[e.jsxs(t,{children:[e.jsx(a,{variant:"subtitle2",color:"text.secondary",children:"First Name"}),e.jsx(a,{variant:"body1",children:r.firstname||r.firstName||"-"})]}),e.jsxs(t,{children:[e.jsx(a,{variant:"subtitle2",color:"text.secondary",children:"Last Name"}),e.jsx(a,{variant:"body1",children:r.lastname||r.lastName||"-"})]}),e.jsxs(t,{children:[e.jsx(a,{variant:"subtitle2",color:"text.secondary",children:"Email"}),e.jsx(a,{variant:"body1",children:r.email||"-"})]}),e.jsxs(t,{children:[e.jsx(a,{variant:"subtitle2",color:"text.secondary",children:"User ID"}),e.jsx(a,{variant:"body1",children:r.id||"-"})]}),e.jsxs(t,{children:[e.jsx(a,{variant:"subtitle2",color:"text.secondary",children:"Role"}),e.jsx(a,{variant:"body1",children:r.role||"-"})]}),e.jsxs(t,{children:[e.jsx(a,{variant:"subtitle2",color:"text.secondary",children:"Department"}),e.jsx(a,{variant:"body1",children:b(r)})]}),e.jsxs(t,{children:[e.jsx(a,{variant:"subtitle2",color:"text.secondary",children:"Status"}),e.jsx(a,{variant:"body1",children:r.status||"active"})]})]})}),e.jsx(M,{sx:{p:{xs:1.5,sm:2}},children:e.jsx(W,{onClick:E,children:"Close"})})]})]})})})]})};export{we as default};
