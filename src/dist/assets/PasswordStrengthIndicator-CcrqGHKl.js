import{r as v,j as s,B as c,b as o,b6 as k,d as C,I as L,ac as z,ab as I,ai as A,ad as w,s as f,ae as u,bd as l,n as p,p as b,q as j}from"./mui-DmyK1VYO.js";class W{constructor(){this.minLength=8,this.maxLength=128,this.requireUppercase=!0,this.requireLowercase=!0,this.requireNumbers=!0,this.requireSpecialChars=!0,this.forbiddenPatterns=[/(.)\1{2,}/,/123|234|345|456|567|678|789|890/,/abc|bcd|cde|def|efg|fgh|ghi|hij|ijk|jkl|klm|lmn|mno|nop|opq|pqr|qrs|rst|stu|tuv|uvw|vwx|wxy|xyz/i,/qwerty|asdfgh|zxcvbn/i],this.commonPasswords=["password","123456","123456789","qwerty","abc123","password123","admin","letmein","welcome","monkey","1234567890","password1","qwerty123","dragon","master","hello","freedom","whatever","qazwsx","trustno1","jordan23","harley","ranger","hunter","buster","soccer","hockey","killer","george","sexy","andrew","charlie","superman","asshole","fuckyou","dallas","jessica","panties","pepper","1234","6969","killer","trust","jordan","jennifer","zxcvbn","asdf","dead","pass","fuck","6969","mustang","letmein","amanda","access","yankees","987654321","dallas","austin","thunder","taylor","matrix","mobilemail","mom","monitor","monitoring","montana","moon","moscow"]}validate(e){const t=[];if(!e)return t.push("Password is required"),{isValid:!1,errors:t};e.length<this.minLength&&t.push(`Password must be at least ${this.minLength} characters long`),e.length>this.maxLength&&t.push(`Password must be no more than ${this.maxLength} characters long`),this.requireUppercase&&!/[A-Z]/.test(e)&&t.push("Password must contain at least one uppercase letter"),this.requireLowercase&&!/[a-z]/.test(e)&&t.push("Password must contain at least one lowercase letter"),this.requireNumbers&&!/\d/.test(e)&&t.push("Password must contain at least one number"),this.requireSpecialChars&&!/[!@#$%^&*()_+\-=[\]{};':"\\|,.<>/?~`]/.test(e)&&t.push("Password must contain at least one special character (!@#$%^&*()_+-=[]{}|;:,.<>?)");for(const n of this.forbiddenPatterns)if(n.test(e)){n.source.includes("\\1")?t.push("Password cannot contain 3 or more consecutive identical characters"):n.source.includes("123|234")?t.push("Password cannot contain sequential numbers (123, 234, etc.)"):n.source.includes("abc|bcd")?t.push("Password cannot contain sequential letters (abc, bcd, etc.)"):n.source.includes("qwerty")&&t.push("Password cannot contain common keyboard patterns");break}return this.commonPasswords.includes(e.toLowerCase())&&t.push("Password is too common. Please choose a more unique password"),this.hasRepeatedSequence(e)&&t.push("Password contains repeated character sequences"),{isValid:t.length===0,errors:t,strength:this.calculateStrength(e)}}hasRepeatedSequence(e){for(let t=0;t<e.length-2;t++){const n=e.substring(t,t+3);if(e.substring(t+3).includes(n))return!0}return!1}calculateStrength(e){let t=0;e.length>=8&&(t+=10),e.length>=12&&(t+=10),e.length>=16&&(t+=5),/[a-z]/.test(e)&&(t+=10),/[A-Z]/.test(e)&&(t+=10),/\d/.test(e)&&(t+=10),/[!@#$%^&*()_+\-=[\]{};':"\\|,.<>/?~`]/.test(e)&&(t+=10);const n=new Set(e).size;return t+=Math.min(n*2,20),e.length>=8&&n>=6&&(t+=15),Math.min(t,100)}getStrengthDescription(e){return e<30?"Very Weak":e<50?"Weak":e<70?"Fair":e<90?"Good":"Strong"}getStrengthColor(e){return e<30?"error":e<50?"warning":e<70?"info":e<90?"primary":"success"}getSuggestions(e){const t=[];return e.some(n=>n.includes("at least"))&&t.push("Use a longer password with at least 8 characters"),e.some(n=>n.includes("uppercase"))&&t.push("Add uppercase letters (A-Z)"),e.some(n=>n.includes("lowercase"))&&t.push("Add lowercase letters (a-z)"),e.some(n=>n.includes("number"))&&t.push("Add numbers (0-9)"),e.some(n=>n.includes("special character"))&&t.push("Add special characters (!@#$%^&*()_+-=[]{}|;:,.<>?)"),e.some(n=>n.includes("consecutive"))&&t.push("Avoid repeating characters (aaa, 111, etc.)"),e.some(n=>n.includes("sequential"))&&t.push("Avoid sequential patterns (123, abc, etc.)"),e.some(n=>n.includes("common"))&&t.push("Choose a more unique password"),t}}const y=new W,E=({password:r,showSuggestions:e=!0,defaultExpanded:t=!1})=>{const[n,m]=v.useState(t),d=y.validate(r||""),i=d.strength,q=d.errors,x=y.getSuggestions(q),g=()=>i<30?"error":i<50?"warning":i<70?"info":i<90?"primary":"success",P=()=>i<30?"Very Weak":i<50?"Weak":i<70?"Fair":i<90?"Good":"Strong",S=()=>[{label:"At least 8 characters",met:r&&r.length>=8,icon:r&&r.length>=8?u:l},{label:"Contains uppercase letter",met:r&&/[A-Z]/.test(r),icon:r&&/[A-Z]/.test(r)?u:l},{label:"Contains lowercase letter",met:r&&/[a-z]/.test(r),icon:r&&/[a-z]/.test(r)?u:l},{label:"Contains number",met:r&&/\d/.test(r),icon:r&&/\d/.test(r)?u:l},{label:"Contains special character",met:r&&/[!@#$%^&*()_+\-=[\]{};':"\\|,.<>/?~`]/.test(r),icon:r&&/[!@#$%^&*()_+\-=[\]{};':"\\|,.<>/?~`]/.test(r)?u:l}];return r?s.jsxs(c,{sx:{mt:2},children:[s.jsxs(c,{sx:{display:"flex",alignItems:"center",justifyContent:"space-between",mb:1},children:[s.jsxs(c,{sx:{display:"flex",alignItems:"center",gap:1},children:[s.jsx(k,{sx:{fontSize:16}}),s.jsx(o,{variant:"caption",color:"text.secondary",children:"Password Strength:"}),s.jsx(C,{label:P(),color:g(),size:"small",sx:{fontWeight:500}})]}),s.jsx(L,{size:"small",onClick:()=>m(!n),sx:{p:.5},children:n?s.jsx(z,{}):s.jsx(I,{})})]}),s.jsx(A,{variant:"determinate",value:i,color:g(),sx:{height:6,borderRadius:3,backgroundColor:"rgba(0,0,0,0.1)",mb:1,"& .MuiLinearProgress-bar":{borderRadius:3}}}),s.jsxs(o,{variant:"caption",color:"text.secondary",sx:{display:"block",textAlign:"right"},children:[i,"% strength"]}),s.jsx(w,{in:n,children:s.jsxs(c,{sx:{mt:2},children:[s.jsxs(c,{sx:{mb:2},children:[s.jsx(o,{variant:"caption",color:"text.secondary",sx:{fontWeight:600},children:"Requirements:"}),s.jsx(f,{dense:!0,sx:{py:0},children:S().map((a,h)=>s.jsxs(p,{sx:{py:.25,px:0},children:[s.jsx(b,{sx:{minWidth:24},children:s.jsx(a.icon,{sx:{fontSize:16,color:a.met?"success.main":"error.main"}})}),s.jsx(j,{primary:s.jsx(o,{variant:"caption",sx:{color:a.met?"success.main":"error.main",fontWeight:a.met?500:400},children:a.label})})]},h))})]}),e&&x.length>0&&s.jsxs(c,{children:[s.jsx(o,{variant:"caption",color:"text.secondary",sx:{fontWeight:600},children:"Suggestions:"}),s.jsx(f,{dense:!0,sx:{py:0},children:x.map((a,h)=>s.jsxs(p,{sx:{py:.25,px:0},children:[s.jsx(b,{sx:{minWidth:24},children:s.jsx(l,{sx:{fontSize:16,color:"warning.main"}})}),s.jsx(j,{primary:s.jsx(o,{variant:"caption",color:"warning.main",children:a})})]},h))})]})]})})]}):s.jsx(c,{sx:{mt:1},children:s.jsx(o,{variant:"caption",color:"text.secondary",children:"Enter a password to see strength indicator"})})};export{E as P,y as p};
